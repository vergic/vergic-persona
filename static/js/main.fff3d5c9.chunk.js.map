{"version":3,"sources":["lib/pattern.js","lib/CanvasDraw.js","ducks/assemble.js","ducks/view.js","store.js","lib/createAnalyticsMiddleware.js","lib/actionMap.js","components/ColorView.js","components/ImageContainer.js","components/ThresholdSlider.js","components/Main.js","components/ImageLoadedContainer.js","components/FileDropZone.js","components/App.js","serviceWorker.js","index.js"],"names":["patternTemplate","id","selected","width","height","mask","emptyRow","size","value","arguments","length","undefined","Array","fill","addPadding","horizPadding","vertPadding","map","empty","concat","Object","toConsumableArray","row","pattern","widthWithoutPadding","vertSize","Math","round","y","val","x","outerRadius","innerRadius","innerDiameter","dx","dy","dist","sqrt","circleCalc","objectSpread","horizSize","drawOnePattern","imageData","colors","pos","color","c","data","CanvasDraw","imageWidth","imageHeight","ctx","columns","patterns","filled","notFilled","backgroundColor","patternImages","imageData0","createImageData","imageData1","forEach","column","cell","pData","patternIndex","putImageData","x0","y0","getRgbColumns","rect","x1","y1","a","rgbaSum","i","nrOfValues","getAverageRgb","d","push","getRect","getNewColumns","nbrOfColumns","maxWidth","maxHeight","emptyCol","colIndex","patternWidth","min","floor","random","createColumn","assemble","createSlice","slice","initialState","threshold","count","reducers","updateWithThreshold","state","action","togglePattern","payload","setImageDimensions","setThreshold","setColumns","initPatterns","setColor","_action$payload","colorId","_action$payload$color","r","g","b","incrementCount","rgbToHex","rgb","hex","Number","toString","selectors","getImageDimensions","createSelector","getColors","colorsCopy","keys","reduce","obj","key","colorArray","_colorArray","slicedToArray","fullColorHex","getCount","updateThreshold","thunk","dispatch","getState","actions","meta","debounce","time","view","blobUrl","setView","setBlobUrl","getView","getBlobUrl","preloadedState","restart","url","window","URL","revokeObjectURL","createAnalyticsMiddleware","dataLayer","actionMap","store","next","actionType","type","split","pop","includes","nextState","transform","logger","createLogger","timestamp","duration","collapsed","predicate","reducer","combineReducers","middleware","createDebounce","thunkMiddleware","event","thresholdValue","getDefaultMiddleware","configureStore","ColorView","_ref","togglePicker","style","useSelector","shallowEqual","txt","react_default","createElement","className","onClick","ImageContainer","imageLoaded","alt","src","onLoad","Handle","Slider","handle","props","dragging","index","restProps","objectWithoutProperties","rc_tooltip_es","prefixCls","overlay","visible","placement","assign","ThresholdSlider","useDispatch","rc_slider_es","max","defaultValue","onAfterChange","Main","init","ceil","initWithImageData","_useState","useState","_useState2","pickerOpen","setPickerOpen","updateColor","useEffect","console","log","drawPatternsWithContext","drawOriginal","canvasRef","current","getContext","img","document","getElementById","drawImage","drawPatternImageWithContext","useRef","canvasDimensions","Card_default","bg","components_ImageContainer","canvas","getImageData","Header","Body","Title","Text","components_ThresholdSlider","components_ColorView","react_color_lib","onAccept","onCancel","onChangeComplete","Footer","Button_default","variant","ref","imageRef","imageDoneLoading","naturalWidth","naturalHeight","generateBlobUrl","blob","Blob","createObjectURL","FileDropZone","progress","setProgress","readFile","file","reader","FileReader","onloadend","e","result","readAsArrayBuffer","onDrop","useCallback","acceptedFiles","_useDropzone","useDropzone","getRootProps","getInputProps","isDragActive","ImageLoadedContainer","v","App","element","components_FileDropZone","components_Main","Boolean","location","hostname","match","render","es","components_App","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.fff3d5c9.chunk.js","sourcesContent":["const outerDiameter = 25;\nconst innerDiameter = 12;//13;\nconst diameterRatio = innerDiameter / outerDiameter;\nconst barWidth = 22.7;\nconst barHeight = 5.5;\nconst barPadding = 2.8;\nconst verticalPaddingRatio = barPadding / barHeight;\nconst barRatio = barHeight / barWidth;\n\nconst patternTemplate = {\n\tid: 'id',\n\tselected: true,\n\twidth: 0,\n\theight: 0,\n\tmask: [],\n};\n\nconst emptyRow = (size, value = 0) => {\n\treturn Array(size).fill(value);\n};\n\n// Vergic circle math function\nconst circleCalc = (x, y, size) => {\n\tconst outerRadius = (size / 2);\n\tconst innerRadius = outerRadius * diameterRatio;\n\tconst dx = (size / 2) - x;\n\tconst dy = (size / 2) - y;\n\tconst dist = Math.sqrt(dx * dx + dy * dy);\n\treturn dist > innerRadius && dist < outerRadius ? 1 : 0;\n};\n\nconst addPadding = (mask, width, horizPadding, vertPadding) => {\n\tvertPadding = Array(vertPadding).fill([]).map(empty => emptyRow(width));\n\thorizPadding = Array(horizPadding).fill(0);\n\treturn [...mask.map(row => row.concat(horizPadding)), ...vertPadding];\n};\n\n// Create Vergic circle pattern\nconst newCirclePattern = (id, width, horizPadding = 2) => {\n\tconst widthWithoutPadding = width - horizPadding;\n\tconst vertSize = Math.round(widthWithoutPadding * barRatio);\n\tconst vertPadding = Math.round(vertSize * verticalPaddingRatio);\n\n\tconst mask = Array(widthWithoutPadding).fill([]).map(empty => emptyRow(widthWithoutPadding))\n\t\t.map((row, y) => row.map((val, x) => circleCalc(x, y, widthWithoutPadding)));\n\n\treturn {\n\t\t...patternTemplate,\n\t\tid,\n\t\twidth,\n\t\theight: widthWithoutPadding + vertPadding,\n\t\tmask: addPadding(mask, width, horizPadding, vertPadding)\n\t};\n};\n\n// Create Vergic bar pattern\nconst newBarPattern = (id, width, horizPadding = 2) => {\n\tconst widthWithoutPadding = width - horizPadding;\n\tconst vertSize = Math.round(widthWithoutPadding * barRatio);\n\tconst vertPadding = Math.round(vertSize * verticalPaddingRatio);\n\tconst horizSize = width - horizPadding;\n\n\tconst mask = Array(vertSize).fill([]).map(empty => emptyRow(horizSize, 1));\n\n\treturn {\n\t\t...patternTemplate,\n\t\tid,\n\t\twidth,\n\t\theight: Math.round(vertSize + vertPadding),\n\t\tmask: addPadding(mask, width, horizPadding, vertPadding)\n\t};\n};\n\n// export default pattern;\nexport default {\n\tnewCirclePattern,\n\tnewBarPattern\n};\n\n\n\n\n","const fillRect = (width, height, imageData, rect, color) => {\n\tconst x0 = rect[0] * 4;\n\tconst y0 = rect[1] * width * 4;\n\tconst x1 = rect[2] * 4;\n\tconst y1 = rect[3] * width * 4;\n\tfor (let x = x0; x < x1; x += 4) {\n\t\tfor (let y = y0; y < y1; y += 4 * width) {\n\t\t\tconst pos = x + y;\n\t\t\tfor (let c = 0; c < color.length; c++) {\n\t\t\t\timageData[pos + c] = color[c];\n\t\t\t}\n\t\t}\n\t}\n};\n\nconst drawPattern = (width, height, imageData, cell, patterns, colors) => {\n\tconst pattern = patterns[cell.patternIndex];\n\tconst {mask} = pattern;\n\tlet {x0, y0, x1, y1, filled} = cell;\n\tconst foregroundColor = filled ? colors.filled : colors.notFilled;\n\tconst backgroundColor = colors.backgroundColor;\n\n\tfor (let x = x0; x < x1; x++) {\n\t\tfor (let y = y0; y < y1; y++) {\n\t\t\tconst dx = x * 4;\n\t\t\tconst dy = y * 4 * width;\n\t\t\tconst color = mask[y - y0][x - x0] === 1 ? foregroundColor : backgroundColor;\n\t\t\tconst pos = dx + dy;\n\t\t\tfor (let c = 0; c < color.length; c++) {\n\t\t\t\timageData[pos + c] = color[c];\n\t\t\t}\n\t\t}\n\t}\n};\n\n\nconst drawOnePattern = (pattern, imageData, colors) => {\n\tfor (let y = 0; y < pattern.height; y++) {\n\t\tfor (let x = 0; x < pattern.width; x++) {\n\t\t\tconst dx = x * 4;\n\t\t\tconst dy = y * 4 * pattern.width;\n\t\t\tconst pos = dx + dy;\n\t\t\tconst color = colors[pattern.mask[y][x]];\n\t\t\tfor (let c = 0; c < color.length; c++) {\n\t\t\t\timageData.data[pos + c] = color[c];\n\t\t\t}\n\t\t}\n\t}\n};\n\nconst drawPatternColumnsWithContext = (imageWidth, imageHeight, ctx, columns, patterns, colors) => {\n\t// create pattern images\n\tconst {filled, notFilled, backgroundColor} = colors;\n\tconst patternImages = patterns.map(pattern => {\n\t\tconst imageData0 = ctx.createImageData(pattern.width, pattern.height);\n\t\tdrawOnePattern(pattern, imageData0, [backgroundColor, notFilled]);\n\n\t\tconst imageData1 = ctx.createImageData(pattern.width, pattern.height);\n\t\tdrawOnePattern(pattern, imageData1, [backgroundColor, filled]);\n\n\t\treturn [imageData0, imageData1]\n\t});\n\t// blit patterns\n\tcolumns.forEach(column => column.forEach(cell => {\n\t\tconst pData = patternImages[cell.patternIndex][cell.filled ? 1 : 0];\n\t\tctx.putImageData(pData, cell.x0, cell.y0);\n\t}));\n};\n\nconst drawPatternColumns = (imageWidth, imageHeight, imageData, columns, patterns, colors) => {\n\tcolumns.forEach(column => column.forEach(cell => {\n\t\tdrawPattern(imageWidth, imageHeight, imageData, cell, patterns, colors);\n\t}));\n};\n\nconst drawColumns = (imageWidth, imageHeight, imageData, columns) => {\n\tcolumns.forEach(column => column.forEach(cell => {\n\t\tconst rect = [cell.x0, cell.y0, cell.x1, cell.y1];\n\t\tconst color = cell.color;\n\t\tfillRect(imageWidth, imageHeight, imageData, rect, color);\n\t}));\n};\n\nconst drawSingleColor = (imageWidth, imageHeight, imageData) => {\n\tconst rect = [0, 0, imageWidth, imageHeight];\n\tfillRect(imageWidth, imageHeight, imageData, rect, [255, 0, 0, 255]);\n\n};\n\nexport default {\n\tdrawColumns,\n\tdrawSingleColor,\n\tdrawPatternColumns,\n\tdrawPatternColumnsWithContext\n};\n\n","import {createSlice, createSelector} from \"redux-starter-kit\";\nimport pattern from \"../lib/pattern\";\nimport CanvasDraw from '../lib/CanvasDraw'\n\n\nconst togglePattern = (state, action) => {\n\tstate.patterns[action.payload.id].selected = !state.patterns[action.payload.id].selected;\n};\n\n\nconst getRect = (width, height, d, rect) => {\n\tconst x0 = rect[0] * 4;\n\tconst y0 = rect[1] * width * 4;\n\tconst x1 = rect[2] * 4;\n\tconst y1 = rect[3] * width * 4;\n\tlet a = [];\n\tfor (let x = x0; x < x1; x += 4) {\n\t\tfor (let y = y0; y < y1; y += 4 * width) {\n\t\t\tconst pos = x + y;\n\t\t\tfor (let c = 0; c < 4; c++) {\n\t\t\t\ta.push(d[pos + c]);\n\t\t\t}\n\t\t}\n\t}\n\treturn a;\n};\n\nconst getAverageRgb = (a) => {\n\tlet rgbaSum = [0, 0, 0, 0];\n\tfor (let i = 0; i < a.length; i += 4) {\n\t\tfor (let c = 0; c < rgbaSum.length; c++) {\n\t\t\trgbaSum[c] += a[i + c];\n\t\t}\n\t}\n\tconst nrOfValues = a.length / 4;\n\tfor (let c = 0; c < rgbaSum.length; c++) {\n\t\trgbaSum[c] = Math.round(rgbaSum[c] / nrOfValues);\n\t}\n\treturn rgbaSum;\n};\n\nconst getRgbColumns = (columns, patterns, imageWidth, imageHeight, imageData) => {\n\treturn columns.map((column) => column.map((cell) => {\n\t\tconst rect = [cell.x0, cell.y0, cell.x1, cell.y1];\n\t\tconst rectData = getRect(imageWidth, imageHeight, imageData, rect);\n\t\tconst color = getAverageRgb(rectData);\n\t\treturn {\n\t\t\t...cell,\n\t\t\tcolor\n\t\t};\n\t}));\n};\n\nconst createColumn = (colIndex, maxWidth, maxHeight, patterns) => {\n\tlet a = [];\n\tlet y0 = 0;\n\tlet y1 = 0;\n\tconst patternWidth = patterns[0].width;\n\tconst x0 = colIndex * patternWidth;\n\tconst x1 = Math.min(x0 + patternWidth, maxWidth);\n\tlet exitMax = 100;\n\twhile (y1 < maxHeight && exitMax > 0) {\n\t\tconst patternIndex = Math.floor(Math.random() * patterns.length);\n\t\tconst pattern = patterns[patternIndex];\n\t\ty1 = Math.min(y0 + pattern.height, maxHeight);\n\t\tconst cell = {\n\t\t\tpatternIndex,\n\t\t\tcolor: [0, 0, 0, 0],\n\t\t\tfilled: false,\n\t\t\tx0,\n\t\t\ty0,\n\t\t\tx1,\n\t\t\ty1,\n\t\t};\n\t\ta.push(cell);\n\t\ty0 = y1;\n\t\t// exitMax--;\n\t}\n\treturn a;\n};\n\nconst getNewColumns = (nbrOfColumns, maxWidth, maxHeight, patterns) => Array(nbrOfColumns).fill([]).map((emptyCol, colIndex) => createColumn(colIndex, maxWidth, maxHeight, patterns));\n\nconst thresholdFunction = (color, threshold) => {\n\tconst colorSum = color[0] + color[1] + color[2];\n\tconst average = colorSum / 3;\n\treturn average < threshold;\n};\n\nconst updateWithThreshold = (state, action) => {\n\tstate.columns = state.columns.map(column => column.map(cell => {\n\t\treturn {\n\t\t\t...cell,\n\t\t\tfilled: thresholdFunction(cell.color, state.threshold)\n\t\t}\n\t}));\n};\n\nconst setImageDimensions = (state, action) => {\n\tstate.imageWidth = action.payload.width;\n\tstate.imageHeight = action.payload.height;\n};\n\nconst setThreshold = (state, action) => {\n\tstate.threshold = action.payload;\n};\n\nconst setColumns = (state, action) => {\n\tstate.columns = action.payload;\n};\n\nconst setColor = (state, action) => {\n\tconst {colorId, color: {r, g, b}} = action.payload;\n\tstate.colors[colorId] = [r, g, b, 255];\n};\n\nconst initPatterns = (state, action) => {\n\tconst patternWidth = action.payload;\n\tstate.patterns = [pattern.newCirclePattern('circle', patternWidth), pattern.newBarPattern('bar', patternWidth)];\n};\n\nconst incrementCount = (state, action) => {\n\tstate.count++;\n};\n\nconst initialState = {\n\timageWidth: 0,\n\timageHeight: 0,\n\tcolumns: [],\n\tpatternWidth: 0,\n\tpatterns: [],\n\tthreshold: 127,\n\tcolors: {\n\t\tfilled: [24, 65, 74, 255],\n\t\tnotFilled: [54, 170, 192, 255],\n\t\tbackgroundColor: [83, 201, 224, 255],\n\n\t},\n\tcount: 0\n};\n\nexport const assemble = createSlice({\n\tslice: 'assemble',\n\tinitialState,\n\treducers: {\n\t\t// init,\n\t\tupdateWithThreshold,\n\t\ttogglePattern,\n\t\tsetImageDimensions,\n\t\tsetThreshold,\n\t\tsetColumns,\n\t\tinitPatterns,\n\t\tsetColor,\n\t\tincrementCount,\n\t}\n});\nconst rgbToHex = function (rgb) {\n\tlet hex = Number(rgb).toString(16);\n\tif (hex.length < 2) {\n\t\thex = \"0\" + hex;\n\t}\n\treturn hex;\n};\nconst fullColorHex = function (colorArray) {\n\tconst [r, g, b] = colorArray;\n\tconst red = rgbToHex(r);\n\tconst green = rgbToHex(g);\n\tconst blue = rgbToHex(b);\n\treturn red + green + blue;\n};\nassemble.selectors = {\n\tgetImageDimensions: createSelector(\n\t\t['assemble.imageWidth', 'assemble.imageHeight'],\n\t\t(imageWidth, imageHeight) => {\n\t\t\treturn {imageWidth, imageHeight};\n\t\t}\n\t),\n\tgetColors: createSelector(\n\t\t['assemble.colors'],\n\t\t(colors) => {\n\t\t\tconst colorsCopy = {...colors};\n\t\t\treturn Object.keys(colorsCopy).reduce((obj, key) => {\n\t\t\t\tobj[key] = '#' + fullColorHex(obj[key]);\n\t\t\t\treturn obj;\n\t\t\t}, colorsCopy)\n\t\t}\n\t),\n\tgetCount: createSelector(\n\t\t['assemble.count'],\n\t\t(count) => {\n\t\t\treturn count;\n\t\t}\n\t)\n};\n\n// Thunks\nexport const initWithImageData = (imageData) => (dispatch, getState) => {\n\n\tlet state = getState().assemble;\n\tconst patternWidth = Math.round(state.imageWidth / 52);\n\tdispatch(assemble.actions.initPatterns(patternWidth));\n\n\tstate = getState().assemble;\n\n\tconst nbrOfColumns = Math.ceil(state.imageWidth / state.patterns[0].width);\n\tlet columns = getNewColumns(nbrOfColumns, state.imageWidth, state.imageHeight, state.patterns);\n\tcolumns = getRgbColumns(columns, state.patterns, state.imageWidth, state.imageHeight, imageData);\n\tdispatch(assemble.actions.setColumns(columns));\n\tdispatch(assemble.actions.incrementCount());\n};\n\nexport const drawBlocksImage = (imageData) => (dispatch, getState) => {\n\tconst state = getState().assemble;\n\tCanvasDraw.drawColumns(state.imageWidth, state.imageHeight, imageData, state.columns);\n};\n\nexport const drawPatternImage = (imageData) => (dispatch, getState) => {\n\tdispatch(assemble.actions.updateWithThreshold());\n\tconst state = getState().assemble;\n\tCanvasDraw.drawPatternColumns(state.imageWidth, state.imageHeight, imageData, state.columns, state.patterns, state.colors);\n};\n\nexport const drawPatternImageWithContext = (ctx) => (dispatch, getState) => {\n\tdispatch(assemble.actions.updateWithThreshold());\n\tconst state = getState().assemble;\n\tCanvasDraw.drawPatternColumnsWithContext(state.imageWidth, state.imageHeight, ctx, state.columns, state.patterns, state.colors);\n};\n\nexport const updateColor = (colorId, color) => {\n\tconst thunk = (dispatch, getState) => {\n\t\tdispatch(assemble.actions.setColor({colorId, color}));\n\t\tdispatch(assemble.actions.incrementCount());\n\t};\n\n\tthunk.meta = {\n\t\tdebounce: {\n\t\t\ttime: 100,\n\t\t\tkey: 'updateColor' + colorId\n\t\t}\n\t};\n\treturn thunk;\n};\n\nexport const updateThreshold = (threshold) => {\n\tconst thunk = (dispatch, getState) => {\n\t\tdispatch(assemble.actions.setThreshold(threshold));\n\t\tdispatch(assemble.actions.incrementCount());\n\t};\n\n\tthunk.meta = {\n\t\tdebounce: {\n\t\t\ttime: 100,\n\t\t\tkey: 'updateThreshold '\n\t\t}\n\t};\n\treturn thunk;\n};","import {createSlice, createSelector} from \"redux-starter-kit\";\n\n\n// use as thunk for later if needed\nconst revokeBlobUrl = (url) => {\n\twindow.URL.revokeObjectURL(url);\n};\n\n\nexport const initialState = {\n\tview: 'dropzone',\n\tblobUrl: '',\n\timageWidth: 0,\n\timageHeight: 0,\n};\n\nconst setBlobUrl = (state, action) => {\n\tstate.blobUrl = action.payload;\n};\n\nconst setView = (state, action) => {\n\tstate.view = action.payload;\n};\n\nconst setImageDimensions = (state, action) => {\n\tstate.imageWidth = action.payload.width;\n\tstate.imageHeight = action.payload.height;\n};\n\nexport const view = createSlice({\n\tslice: 'view',\n\tinitialState,\n\treducers: {\n\t\tsetView,\n\t\tsetBlobUrl,\n\t\tsetImageDimensions\n\t}\n});\nview.selectors = {\n\tgetView: createSelector(\n\t\t['view.view'],\n\t\t(view) => {\n\t\t\treturn view;\n\t\t}\n\t),\n\tgetBlobUrl: createSelector(\n\t\t['view.blobUrl'],\n\t\t(blobUrl) => {\n\t\t\treturn blobUrl;\n\t\t}\n\t),\n};\n\n\n// Thunks\nexport const restart = () => (dispatch, getState) => {\n\trevokeBlobUrl(getState().view.blobUrl);\n\tdispatch(view.actions.setView('dropzone'));\n};\n\n\n\n\n","import {configureStore, getDefaultMiddleware, createReducer, createAction} from 'redux-starter-kit'\nimport {combineReducers} from \"redux\";\nimport thunkMiddleware from 'redux-thunk'\nimport {createLogger} from 'redux-logger'\nimport createDebounce from 'redux-debounced';\nimport {assemble} from './ducks/assemble'\nimport {view} from './ducks/view'\nimport createAnalyticsMiddleware from './lib/createAnalyticsMiddleware'\nimport actionMap from './lib/actionMap'\n\nconst initialState = {};\n// patterns: [],\n// columns: [],\n// };\n\n\nconst logger2 = ({getState}) => {\n\treturn (next) => (action) => {\n\n\t\tconsole.log('logger', action);\n\t\tconst returnValue = next(action);\n\t\tconst nextState = getState();\n\n\t\treturn returnValue\n\t}\n};\n\n\nconst logger = createLogger({\n\ttimestamp: true,\n\tduration: true,\n\tcollapsed: true,\n\tpredicate: true,\n});\n\nconst reducer = combineReducers({\n\tassemble: assemble.reducer,\n\tview: view.reducer\n});\n\n// const middleware = [thunkMiddleware, logger, createDebounce, ...getDefaultMiddleware()];\nconst middleware = [createDebounce(), thunkMiddleware, logger, createAnalyticsMiddleware(window.dataLayer || [], actionMap), ...getDefaultMiddleware()];\nconst configureAppStore = (preloadedState) => {\n\tconst store = configureStore({\n\t\treducer,\n\t\tmiddleware,\n\t\tpreloadedState,\n\t});\n\n\t// if (process.env.NODE_ENV !== 'production' && module.hot) {\n\t// \tmodule.hot.accept('./reducers', () => store.replaceReducer(reducer))\n\t// }\n\n\treturn store\n};\n\nconst store = configureAppStore(initialState);\n\nexport default store;\n","const createAnalyticsMiddleware = (dataLayer = [], actionMap = {}) => store => next => action => {\n\tnext(action);\n\n\tconst actionType = action.type.split('/').pop();\n\tif (!Object.keys(actionMap).includes(actionType)) {\n\t\treturn;\n\t}\n\tconst nextState = store.getState();\n\tconst transform = actionMap[actionType];\n\tconst data = transform(action, nextState);\n\tdataLayer.push(data);\n};\nexport default createAnalyticsMiddleware;\n","export default {\n\t'setThreshold': (action, store) => {\n\t\tconst actionType = action.type.split('/').pop();\n\t\treturn {\n\t\t\tevent: actionType,\n\t\t\tthresholdValue: action.payload\n\t\t};\n\t}\n};\n","import React from \"react\";\nimport {useSelector, shallowEqual} from 'react-redux'\nimport {assemble} from '../ducks/assemble'\n\n\nfunction ColorView({colorId, togglePicker}) {\n\n\tconst color = useSelector(assemble.selectors.getColors, shallowEqual)[colorId];\n\tconst style = {\n\t\tbackgroundColor: color\n\t};\n\tconst txt = {\n\t\tfilled: 'filled',\n\t\tnotFilled: 'empty',\n\t\tbackgroundColor: 'background'\n\t}[colorId];\n\n\treturn (\n\t\t<div className=\"\">\n\t\t\t<div className=\"color-box\" style={style} onClick={() => togglePicker(colorId)}>\n\t\t\t\t{txt}\n\t\t\t</div>\n\n\t\t</div>\n\t)\n}\n\nexport default ColorView;\n\n","import React from \"react\";\n\nfunction ImageContainer({url, id, imageLoaded}) {\n\treturn (\n\t\t<div className=\"image-container\">\n\t\t\t<img alt=\"preview\" id={id} className=\"preview-image\" src={url} onLoad={() => imageLoaded()}/>\n\t\t</div>\n\t)\n}\n\nexport default ImageContainer;\n\n","import React from \"react\";\nimport 'rc-slider/assets/index.css';\nimport 'rc-tooltip/assets/bootstrap.css';\nimport '../App.css';\nimport {useDispatch, useSelector, shallowEqual} from 'react-redux'\nimport Slider from 'rc-slider';\nimport Tooltip from 'rc-tooltip';\n\nimport {updateThreshold} from '../ducks/assemble'\n\nconst Handle = Slider.Handle;\n\nconst handle = (props) => {\n\tconst {value, dragging, index, ...restProps} = props;\n\treturn (\n\t\t<Tooltip\n\t\t\tprefixCls=\"rc-slider-tooltip\"\n\t\t\toverlay={value}\n\t\t\tvisible={dragging}\n\t\t\tplacement=\"top\"\n\t\t\tkey={index}\n\t\t>\n\t\t\t<Handle value={value} {...restProps} />\n\t\t</Tooltip>\n\t);\n};\n\n\nfunction ThresholdSlider() {\n\tconst dispatch = useDispatch();\n\tconst setThreshold = (v) => {\n\t\tdispatch(updateThreshold(v));\n\t};\n\n\treturn (\n\t\t<div className=\"slider\">\n\t\t\t<Slider min={0} max={255} defaultValue={127} handle={handle}\n\t\t\t        onAfterChange={(value) => setThreshold(value)}/>\n\t\t</div>\n\t);\n}\n\nexport default ThresholdSlider;\n\n","import React, {useRef, useState, useEffect} from \"react\";\nimport {useDispatch, useSelector, shallowEqual} from 'react-redux'\nimport Button from 'react-bootstrap/Button';\nimport Card from 'react-bootstrap/Card';\nimport {PhotoshopPicker} from 'react-color'\nimport ColorView from './ColorView'\nimport ImageContainer from './ImageContainer'\nimport ThresholdSlider from './ThresholdSlider'\nimport {\n\tassemble,\n\tinitWithImageData,\n\tdrawBlocksImage,\n\tdrawPatternImage,\n\tdrawPatternImageWithContext,\n\tupdateColor\n} from '../ducks/assemble'\nimport {view, restart} from '../ducks/view'\n\nconst Main = () => {\n\n\tconst dispatch = useDispatch();\n\tconst init = (imageData) => dispatch(initWithImageData(imageData));\n\n\tconst [pickerOpen, setPickerOpen] = useState('');\n\tconst color = useSelector(assemble.selectors.getColors, shallowEqual)[pickerOpen] || '';\n\tconst setColor = (colorId, color) => dispatch(updateColor(colorId, color));\n\n\tconst togglePicker = (colorId) => {\n\t\tconst p = pickerOpen === colorId\n\t\t\t? ''\n\t\t\t: colorId;\n\n\t\tsetPickerOpen(p);\n\t};\n\n\tconst startOver = () => {\n\t\tdispatch(restart());\n\t};\n\n\tconst count = useSelector(assemble.selectors.getCount, shallowEqual);\n\tuseEffect(\n\t\t() => {\n\t\t\tconsole.log('draw');\n\t\t\tdrawPatternsWithContext();\n\t\t\treturn () => console.log('clean');\n\t\t}, [count]);\n\n\tconst imageLoaded = () => {\n\t\tconst {imageWidth, imageHeight} = canvasDimensions;\n\t\tconst canvas = canvasRef.current;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tctx.canvas.width = imageWidth;\n\t\tctx.canvas.height = imageHeight;\n\t\tdrawOriginal();\n\t\tconst imageData = ctx.getImageData(0, 0, imageWidth, imageHeight);\n\t\tinit(imageData.data);\n\t};\n\n\tconst drawOriginal = () => {\n\t\tconst canvas = canvasRef.current;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tconst img = document.getElementById('orig');\n\t\tctx.drawImage(img, 0, 0);\n\t};\n\n\tconst drawBlocks = () => {\n\t\tconst {imageWidth, imageHeight} = canvasDimensions;\n\t\tconst canvas = canvasRef.current;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tconst imageData = ctx.getImageData(0, 0, imageWidth, imageHeight);\n\t\tdispatch(drawBlocksImage(imageData.data));\n\t\tctx.putImageData(imageData, 0, 0);\n\t};\n\n\tconst drawPatterns = () => {\n\t\tconst {imageWidth, imageHeight} = canvasDimensions;\n\t\tconst canvas = canvasRef.current;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tconst imageData = ctx.getImageData(0, 0, imageWidth, imageHeight);\n\t\tdispatch(drawPatternImage(imageData.data));\n\t\tctx.putImageData(imageData, 0, 0);\n\t};\n\n\tconst drawPatternsWithContext = () => {\n\t\tconst canvas = canvasRef.current;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tdispatch(drawPatternImageWithContext(ctx));\n\t};\n\n\tconst blobUrl = useSelector(view.selectors.getBlobUrl, shallowEqual);\n\tconst canvasRef = useRef(null);\n\tconst canvasDimensions = useSelector(assemble.selectors.getImageDimensions, shallowEqual);\n\n\treturn (\n\t\t<div className=\"main\">\n\t\t\t<Card className=\"card\" bg=\"success\" style={{width: '28rem'}}>\n\t\t\t\t<ImageContainer url={blobUrl} id={'orig'} imageLoaded={imageLoaded}/>\n\t\t\t\t<Card.Header>Vergic Persona</Card.Header>\n\t\t\t\t<Card.Body>\n\t\t\t\t\t<Card.Title>Visibility Settings</Card.Title>\n\t\t\t\t\t<Card.Text>\n\t\t\t\t\t\tDrag slider to modify visibility\n\t\t\t\t\t</Card.Text>\n\t\t\t\t\t<ThresholdSlider/>\n\t\t\t\t\t<Card.Title>Color Settings</Card.Title>\n\t\t\t\t\t<div className=\"color-section\">\n\t\t\t\t\t\t<ColorView colorId={'backgroundColor'} togglePicker={togglePicker}/>\n\t\t\t\t\t\t<ColorView colorId={'filled'} togglePicker={togglePicker}/>\n\t\t\t\t\t\t<ColorView colorId={'notFilled'} togglePicker={togglePicker}/>\n\t\t\t\t\t</div>\n\t\t\t\t\t{pickerOpen !== ''\n\t\t\t\t\t\t? (<PhotoshopPicker\n\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\tonAccept={() => togglePicker()}\n\t\t\t\t\t\t\tonCancel={() => togglePicker()}\n\t\t\t\t\t\t\tonChangeComplete={(c) => setColor(pickerOpen, c.rgb)}\n\t\t\t\t\t\t/>)\n\t\t\t\t\t\t: null}\n\t\t\t\t\t{/*<Button variant=\"primary\" onClick={() => drawPatterns()}>Generate</Button>*/}\n\t\t\t\t</Card.Body>\n\t\t\t\t<Card.Footer>\n\t\t\t\t\t<Button variant=\"warning\" onClick={() => startOver()}>start over</Button>\n\t\t\t\t</Card.Footer>\n\t\t\t</Card>\n\t\t\t<div className=\"generated-image-container\">\n\t\t\t\t<canvas\n\t\t\t\t\tclassName=\"preview-image\"\n\t\t\t\t\tref={canvasRef}\n\t\t\t\t\twidth={800}\n\t\t\t\t\theight={800}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default Main;\n\n","import React, {useEffect, useRef} from \"react\";\nimport {useDispatch} from 'react-redux'\nimport {assemble} from '../ducks/assemble'\n\nfunction ImageContainer({url, imageLoaded}) {\n\tconst imageRef = useRef(null);\n\tconst dispatch = useDispatch();\n\tconst setImageDimensions = (width, height) => dispatch(assemble.actions.setImageDimensions({width, height}));\n\n\tconst imageDoneLoading = () => {\n\t\tsetImageDimensions(imageRef.current.naturalWidth, imageRef.current.naturalHeight);\n\t\timageLoaded();\n\t};\n\n\t// useEffect(() => {\n\t// \treturn () => setImageDimensions(imageRef.current.naturalWidth, imageRef.current.naturalHeight);\n\t// }, [url]);\n\n\treturn (\n\t\t<div className=\"image-container\">\n\t\t\t<img alt=\"preview\" ref={imageRef} className=\"preview-image\" src={url} onLoad={() => imageDoneLoading()}/>\n\t\t</div>\n\t)\n}\n\nexport default ImageContainer;\n\n","import React, {useCallback, useState} from 'react'\nimport {useDispatch, useSelector, shallowEqual} from 'react-redux'\nimport {useDropzone} from 'react-dropzone'\nimport ImageLoadedContainer from './ImageLoadedContainer'\nimport {view} from '../ducks/view'\nimport {assemble} from '../ducks/assemble'\n\nconst generateBlobUrl = (data, type = 'octet/stream') => {\n\tconst blob = new Blob([data], {type});\n\treturn window.URL.createObjectURL(blob);\n};\n\nfunction FileDropZone() {\n\n\tconst setView = (v) => dispatch(view.actions.setView(v));\n\n\tconst imageLoaded = () => {\n\t\tsetView('main')\n\t};\n\n\tconst dispatch = useDispatch();\n\tconst blobUrl = useSelector(view.selectors.getBlobUrl, shallowEqual);\n\tconst setBlobUrl = (url) => dispatch(view.actions.setBlobUrl(url));\n\n\tconst [progress, setProgress] = useState('waiting');\n\n\tconst readFile = (file) => {\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\t\tconst reader = new FileReader();\n\t\treader.onloadend = (e) => {\n\t\t\tconst blobUrl = generateBlobUrl(reader.result);\n\t\t\tsetProgress('done');\n\t\t\tsetBlobUrl(blobUrl);\n\t\t};\n\t\tsetProgress('loading');\n\t\treader.readAsArrayBuffer(file);\n\t};\n\n\tconst onDrop = useCallback(acceptedFiles => {\n\t\treadFile(acceptedFiles[0]);\n\t});\n\n\tconst {getRootProps, getInputProps, isDragActive} = useDropzone({onDrop});\n\n\treturn (\n\t\t<div className=\"dropzone-container\" {...getRootProps()}>\n\t\t\t<h1>Vergic Persona</h1>\n\t\t\t<input {...getInputProps()} />\n\t\t\t{\n\t\t\t\tisDragActive ?\n\t\t\t\t\t<p>Drop the image here ...</p> :\n\t\t\t\t\t<p>Drag 'n' drop an image here, or click to select an image</p>\n\t\t\t}\n\t\t\t{progress === 'done'\n\t\t\t\t? <ImageLoadedContainer url={blobUrl} imageLoaded={imageLoaded}/>\n\t\t\t\t: null}\n\t\t</div>\n\t)\n}\n\nexport default FileDropZone;\n","import React from \"react\";\nimport '../App.css';\nimport Button from 'react-bootstrap/Button';\nimport Main from './Main'\nimport FileDropZone from './FileDropZone'\nimport {useDispatch, useSelector, shallowEqual} from 'react-redux'\n\nimport {view} from '../ducks/view'\n\nfunction App() {\n\tconst dispatch = useDispatch();\n\tconst currentView = useSelector(view.selectors.getView, shallowEqual);\n\tconst setView = (v) => dispatch(view.actions.setView(v));\n\n\tlet element = null;\n\tswitch (currentView) {\n\t\tcase 'start':\n\t\t\telement = <div>hello</div>;\n\t\t\tbreak;\n\t\tcase 'dropzone':\n\t\t\telement = <FileDropZone/>;\n\t\t\tbreak;\n\t\tcase 'main':\n\t\t\telement = <Main/>;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\telement = <div>default</div>;\n\t}\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t{element}\n\t\t\t{/*<Button variant=\"primary\" onClick={() => setView('start')}>Start</Button>*/}\n\t\t\t{/*<Button variant=\"primary\" onClick={() => setView('dropzone')}>Dropzone</Button>*/}\n\t\t\t{/*<Button variant=\"primary\" onClick={() => setView('main')}>Main</Button>*/}\n\t\t</div>\n\t);\n}\n\nexport default App;\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport {render} from \"react-dom\";\nimport {Provider} from \"react-redux\";\nimport store from \"./store\";\nimport App from \"./components/App\";\nimport * as serviceWorker from './serviceWorker';\nimport './index.css';\n\nrender(\n\t<Provider store={store}>\n\t\t<App/>\n\t</Provider>,\n\tdocument.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n\n"],"sourceRoot":""}