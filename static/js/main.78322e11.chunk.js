(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t,n){},179:function(e,t,n){e.exports=n(420)},419:function(e,t,n){},420:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(8),i=n(7),c=n(54),l=n(19),u=n(17),s=n(75),d=n(169),m=n(170),g=n.n(m),f=n(45),h=n(39),b={id:"id",selected:!0,width:0,height:0,mask:[]},v=function(e){return Array(e).fill(0)},p=function(e,t){var n=Array(t).fill([]).map(function(e){return v(t)}).map(function(e,n){return e.map(function(e,a){return function(e,t,n){var a=n/2,r=.48*a,o=n/2-e,i=n/2-t,c=Math.sqrt(o*o+i*i);return c>r&&c<a?1:0}(a,n,t-1)})});return Object(h.a)({},b,{id:e,width:t,height:t+2,mask:[v(t)].concat(Object(c.a)(n),[v(t)])})},w=function(e,t){var n=Array(13).fill([]).map(function(e){return v(t)}).map(function(e,n){return e.map(function(e,a){return function(e,t,n,a,r){return e<r||t<r||e>n-r||t>a-r?0:1}(a,n,t,13,2)})});return Object(h.a)({},b,{id:e,width:t,height:15,mask:[v(t)].concat(Object(c.a)(n),[v(t)])})},j=function(e,t,n){for(var a=0;a<e.height;a++)for(var r=0;r<e.width;r++)for(var o=4*r+4*a*e.width,i=n[e.mask[a][r]],c=0;c<i.length;c++)t.data[o+c]=i[c]},O=function(e,t,n,a,r,o){var i=o.filled,c=o.notFilled,l=o.backgroundColor,u=r.map(function(e){var t=n.createImageData(e.width,e.height);j(e,t,[l,c]);var a=n.createImageData(e.width,e.height);return j(e,a,[l,i]),[t,a]});a.forEach(function(e){return e.forEach(function(e){var t=u[e.patternIndex][e.filled?1:0];n.putImageData(t,e.x0,e.y0)})})},E=function(e,t,n,a,r){return e.map(function(e){return e.map(function(e){var t=[e.x0,e.y0,e.x1,e.y1],a=function(e){for(var t=[0,0,0,0],n=0;n<e.length;n+=4)for(var a=0;a<t.length;a++)t[a]+=e[n+a];for(var r=e.length/4,o=0;o<t.length;o++)t[o]=Math.round(t[o]/r);return t}(function(e,t,n,a){for(var r=4*a[0],o=a[1]*e*4,i=4*a[2],c=a[3]*e*4,l=[],u=r;u<i;u+=4)for(var s=o;s<c;s+=4*e)for(var d=u+s,m=0;m<4;m++)l.push(n[d+m]);return l}(n,0,r,t));return Object(h.a)({},e,{color:a})})})},y=function(e,t,n,a){return Array(e).fill([]).map(function(e,r){return function(e,t,n,a){for(var r=[],o=0,i=0,c=a[0].width,l=e*c,u=Math.min(l+c,t);i<n;){var s=Math.floor(Math.random()*a.length),d=a[s],m={patternIndex:s,color:[0,0,0,0],filled:!1,x0:l,y0:o,x1:u,y1:i=Math.min(o+d.height,n)};r.push(m),o=i}return r}(r,t,n,a)})},k=Object(l.c)({slice:"assemble",initialState:{imageWidth:0,imageHeight:0,columns:[],patternWidth:0,patterns:[],threshold:127,colors:{filled:[24,65,74,255],notFilled:[54,170,192,255],backgroundColor:[83,201,224,255]},count:0},reducers:{updateWithThreshold:function(e,t){e.columns=e.columns.map(function(t){return t.map(function(t){return Object(h.a)({},t,{filled:(n=t.color,a=e.threshold,(n[0]+n[1]+n[2])/3<a)});var n,a})})},togglePattern:function(e,t){e.patterns[t.payload.id].selected=!e.patterns[t.payload.id].selected},setImageDimensions:function(e,t){e.imageWidth=t.payload.width,e.imageHeight=t.payload.height},setThreshold:function(e,t){e.threshold=t.payload},setColumns:function(e,t){e.columns=t.payload},initPatterns:function(e,t){var n=t.payload;e.patterns=[p("circle",n),w("bar",n)]},setColor:function(e,t){var n=t.payload,a=n.colorId,r=n.color,o=r.r,i=r.g,c=r.b;e.colors[a]=[o,i,c,255]},incrementCount:function(e,t){e.count++}}}),C=function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t};k.selectors={getImageDimensions:Object(l.b)(["assemble.imageWidth","assemble.imageHeight"],function(e,t){return{imageWidth:e,imageHeight:t}}),getColors:Object(l.b)(["assemble.colors"],function(e){var t=Object(h.a)({},e);return Object.keys(t).reduce(function(e,t){return e[t]="#"+function(e){var t=Object(f.a)(e,3),n=t[0],a=t[1],r=t[2];return C(n)+C(a)+C(r)}(e[t]),e},t)}),getCount:Object(l.b)(["assemble.count"],function(e){return e})};var I=function(e){var t=function(t,n){t(k.actions.setThreshold(e)),t(k.actions.incrementCount())};return t.meta={debounce:{time:100,key:"updateThreshold "}},t},W=Object(l.c)({slice:"view",initialState:{view:"dropzone",blobUrl:"",imageWidth:0,imageHeight:0},reducers:{setView:function(e,t){e.view=t.payload},setBlobUrl:function(e,t){e.blobUrl=t.payload},setImageDimensions:function(e,t){e.imageWidth=t.payload.width,e.imageHeight=t.payload.height}}});W.selectors={getView:Object(l.b)(["view.view"],function(e){return e}),getBlobUrl:Object(l.b)(["view.blobUrl"],function(e){return e})};var x,N=function(){return function(e,t){var n;n=t().view.blobUrl,window.URL.revokeObjectURL(n),e(W.actions.setView("dropzone"))}},D=Object(d.createLogger)({timestamp:!0,duration:!0,collapsed:!0,predicate:!0}),H=Object(u.combineReducers)({assemble:k.reducer,view:W.reducer}),P=[g()(),s.a,D].concat(Object(c.a)(Object(l.d)())),U=(x={},Object(l.a)({reducer:H,middleware:P,preloadedState:x})),B=(n(118),n(112)),L=n.n(B),A=n(31),R=n.n(A),V=n(172);var M=function(e){var t=e.colorId,n=e.togglePicker,a={backgroundColor:Object(i.d)(k.selectors.getColors,i.b)[t]},o={filled:"filled",notFilled:"empty",backgroundColor:"background"}[t];return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"color-box",style:a,onClick:function(){return n(t)}},o))};var S=function(e){var t=e.url,n=e.id,a=e.imageLoaded;return r.a.createElement("div",{className:"image-container"},r.a.createElement("img",{alt:"preview",id:n,className:"preview-image",src:t,onLoad:function(){return a()}}))},T=n(178),F=(n(355),n(356),n(116)),z=n(76),J=F.a.Handle,q=function(e){var t=e.value,n=e.dragging,a=e.index,o=Object(T.a)(e,["value","dragging","index"]);return r.a.createElement(z.a,{prefixCls:"rc-slider-tooltip",overlay:t,visible:n,placement:"top",key:a},r.a.createElement(J,Object.assign({value:t},o)))};var $=function(){var e=Object(i.c)();return r.a.createElement("div",{className:"slider"},r.a.createElement(F.a,{min:0,max:255,defaultValue:127,handle:q,onAfterChange:function(t){e(I(t))}}))},G=function(){var e=Object(i.c)(),t=function(t){return e(function(e){return function(t,n){var a=n().assemble,r=Math.round(a.imageWidth/52);t(k.actions.initPatterns(r)),a=n().assemble;var o=Math.ceil(a.imageWidth/a.patterns[0].width),i=y(o,a.imageWidth,a.imageHeight,a.patterns);i=E(i,a.patterns,a.imageWidth,a.imageHeight,e),t(k.actions.setColumns(i)),t(k.actions.incrementCount())}}(t))},n=Object(a.useState)(""),o=Object(f.a)(n,2),c=o[0],l=o[1],u=Object(i.d)(k.selectors.getColors,i.b)[c]||"",s=function(t,n){return e(function(e,t){var n=function(n,a){n(k.actions.setColor({colorId:e,color:t})),n(k.actions.incrementCount())};return n.meta={debounce:{time:100,key:"updateColor"+e}},n}(t,n))},d=function(e){l(c===e?"":e)},m=Object(i.d)(k.selectors.getCount,i.b);Object(a.useEffect)(function(){return console.log("draw"),h(),function(){return console.log("clean")}},[m]);var g=function(){var e=v.current.getContext("2d"),t=document.getElementById("orig");e.drawImage(t,0,0)},h=function(){var t=v.current.getContext("2d");e(function(e){return function(t,n){t(k.actions.updateWithThreshold());var a=n().assemble;O(a.imageWidth,a.imageHeight,e,a.columns,a.patterns,a.colors)}}(t))},b=Object(i.d)(W.selectors.getBlobUrl,i.b),v=Object(a.useRef)(null),p=Object(i.d)(k.selectors.getImageDimensions,i.b);return r.a.createElement("div",{className:"main"},r.a.createElement(R.a,{className:"card",bg:"success",style:{width:"28rem"}},r.a.createElement(S,{url:b,id:"orig",imageLoaded:function(){var e=p.imageWidth,n=p.imageHeight,a=v.current.getContext("2d");a.canvas.width=e,a.canvas.height=n,g();var r=a.getImageData(0,0,e,n);t(r.data)}}),r.a.createElement(R.a.Header,null,"Vergic Persona"),r.a.createElement(R.a.Body,null,r.a.createElement(R.a.Title,null,"Visibility Settings"),r.a.createElement(R.a.Text,null,"Drag slider to modify visibility"),r.a.createElement($,null),r.a.createElement(R.a.Title,null,"Color Settings"),r.a.createElement("div",{className:"color-section"},r.a.createElement(M,{colorId:"backgroundColor",togglePicker:d}),r.a.createElement(M,{colorId:"filled",togglePicker:d}),r.a.createElement(M,{colorId:"notFilled",togglePicker:d})),""!==c?r.a.createElement(V.PhotoshopPicker,{color:u,onAccept:function(){return d()},onCancel:function(){return d()},onChangeComplete:function(e){return s(c,e.rgb)}}):null),r.a.createElement(R.a.Footer,null,r.a.createElement(L.a,{variant:"warning",onClick:function(){e(N())}},"start over"))),r.a.createElement("div",{className:"generated-image-container"},r.a.createElement("canvas",{className:"preview-image",ref:v,width:600,height:600})))},K=n(177);var Q=function(e){var t=e.url,n=e.imageLoaded,o=Object(a.useRef)(null),c=Object(i.c)(),l=function(){var e,t;e=o.current.naturalWidth,t=o.current.naturalHeight,c(k.actions.setImageDimensions({width:e,height:t})),n()};return r.a.createElement("div",{className:"image-container"},r.a.createElement("img",{alt:"preview",ref:o,className:"preview-image",src:t,onLoad:function(){return l()}}))},X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"octet/stream",n=new Blob([e],{type:t});return window.URL.createObjectURL(n)};var Y=function(){var e=Object(i.c)(),t=Object(i.d)(W.selectors.getBlobUrl,i.b),n=Object(a.useState)("waiting"),o=Object(f.a)(n,2),c=o[0],l=o[1],u=function(t){if(t){var n=new FileReader;n.onloadend=function(t){var a,r=X(n.result);l("done"),a=r,e(W.actions.setBlobUrl(a))},l("loading"),n.readAsArrayBuffer(t)}},s=Object(a.useCallback)(function(e){u(e[0])}),d=Object(K.a)({onDrop:s}),m=d.getRootProps,g=d.getInputProps,h=d.isDragActive;return r.a.createElement("div",Object.assign({className:"dropzone-container"},m()),r.a.createElement("h1",null,"Vergic Persona"),r.a.createElement("input",g()),h?r.a.createElement("p",null,"Drop the image here ..."):r.a.createElement("p",null,"Drag 'n' drop an image here, or click to select an image"),"done"===c?r.a.createElement(Q,{url:t,imageLoaded:function(){var t;t="main",e(W.actions.setView(t))}}):null)};var Z=function(){Object(i.c)();var e=null;switch(Object(i.d)(W.selectors.getView,i.b)){case"start":e=r.a.createElement("div",null,"hello");break;case"dropzone":e=r.a.createElement(Y,null);break;case"main":e=r.a.createElement(G,null);break;default:e=r.a.createElement("div",null,"default")}return r.a.createElement("div",{className:"App"},e)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(419);Object(o.render)(r.a.createElement(i.a,{store:U},r.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[179,1,2]]]);
//# sourceMappingURL=main.78322e11.chunk.js.map